---
import Layout from "../layouts/Layout.astro";
import BlogCard from "../components/BlogCard.astro";
import BaseLink from "../components/ui/BaseLink.astro";
import PageHeader from "../components/ui/PageHeader.astro";
import "../styles/global.css";
import { formatReadingTime } from "../utils/reading-time";
import { getPosts, getAllTags } from "../utils/posts";
import { formatBlogDate } from "../utils/date";

const allPosts = getPosts(true);
const uniqueTags = getAllTags(allPosts);
---

<Layout title="baju | blog">
  <PageHeader title="Blog" subtitle="This is where I share things that I'm working on, find interesting, want to learn more about, or whatever else I feel like writing.">
    <div class="flex items-center gap-4 mt-4">
      <span class="text-muted">{allPosts.length} post{allPosts.length !== 1 ? 's' : ''}</span>
      <span class="text-muted">â€¢</span>
      <BaseLink href="/rss.xml" variant="rss">RSS</BaseLink>
    </div>
  </PageHeader>

  <section class="space-y-10">
    <div class="space-y-6">
      {allPosts.map((post) => (
        <BlogCard
          url={post.url}
          title={post.title}
          description={post.description}
          pubDate={formatBlogDate(post.pubDate)}
          tags={post.tags}
          readingTime={post.readingTime && formatReadingTime(post.readingTime)}
        />
      ))}
    </div>
  </section>
</Layout>